{% load static %}

{% load apartment_filters %}


<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ apartment.name }} | ES Homes & Apartments</title>
    <meta name="description" content="{{ apartment.description|truncatewords:25 }}">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link rel="stylesheet" href="{% static 'css/animations.css' %}">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Using system fonts - no Google Fonts needed -->
    <style>
        /* Additional styles for apartment detail page */
        .apartment-detail {
            padding: 60px 0;
            margin-top: 90px;
        }
        
        .apartment-detail-grid {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 40px;
        }
        
        .gallery-main {
            margin-bottom: 20px;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            height: 500px;
        }
        
        .gallery-main-image {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .gallery-thumbs {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 15px;
        }
        
        .gallery-thumb {
            height: 100px;
            border-radius: var(--border-radius);
            overflow: hidden;
            cursor: pointer;
            transition: var(--transition);
            opacity: 0.7;
        }
        
        .gallery-thumb img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .gallery-thumb.active {
            opacity: 1;
            box-shadow: 0 0 0 3px var(--primary-color);
        }
        
        .apartment-info {
            background-color: var(--white);
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--shadow);
        }
        
        .apartment-title {
            font-size: 2.2rem;
            margin-bottom: 15px;
        }
        
        .apartment-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 20px;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .meta-item {
            display: flex;
            align-items: center;
        }
        
        .meta-item i {
            color: var(--primary-color);
            font-size: 1.2rem;
            margin-right: 10px;
        }
        
        .apartment-price {
            display: flex;
            align-items: baseline;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .price {
            font-size: 2rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .period {
            font-size: 1rem;
            color: var(--text-light);
            margin-left: 5px;
        }
        
        .booking-form {
            margin-top: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 500;
        }
        
        .form-control {
            width: 100%;
            padding: 12px 15px;
            border-radius: var(--border-radius);
            border: 1px solid #ddd;
            transition: var(--transition);
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            outline: none;
        }
        
        .booking-total {
            background-color: var(--light-color);
            padding: 15px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .booking-total-label {
            font-weight: 600;
        }
        
        .booking-total-price {
            font-size: 1.2rem;
            font-weight: 700;
            color: var(--primary-color);
        }
        
        .features-section {
            padding: 60px 0;
            background-color: var(--light-color);
        }
        
        .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        .feature-item {
            background-color: var(--white);
            padding: 25px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            text-align: center;
            transition: var(--transition);
        }
        
        .feature-item:hover {
            transform: translateY(-5px);
        }
        
        .feature-icon {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .feature-title {
            font-size: 1.2rem;
            margin-bottom: 10px;
        }
        
        .feature-text {
            color: var(--text-light);
            margin-bottom: 0;
        }
        
        .description-section {
            padding: 60px 0;
        }
        
        .description-content {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 40px;
            align-items: center;
        }
        
        .description-image {
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
        }
        
        .description-text h3 {
            margin-bottom: 20px;
        }
        
        .description-list {
            margin: 20px 0;
        }
        
        .description-list li {
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        
        .description-list li i {
            color: var(--primary-color);
            margin-right: 10px;
        }
        
        .map-section {
            padding: 60px 0;
            background-color: var(--light-color);
        }
        
        .map-container {
            height: 400px;
            border-radius: var(--border-radius);
            overflow: hidden;
            box-shadow: var(--shadow);
            margin-top: 40px;
        }
        
        .map-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }
        
        .similar-section {
            padding: 60px 0;
        }
        
        .similar-apartments {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }
        
        @media screen and (max-width: 992px) {
            .apartment-detail-grid {
                grid-template-columns: 1fr;
            }
            
            .description-content {
                grid-template-columns: 1fr;
            }
            
            .description-image {
                margin-bottom: 30px;
            }
        }
        
        @media screen and (max-width: 768px) {
            .gallery-main {
                height: 350px;
            }
            
            .gallery-thumbs {
                grid-template-columns: repeat(3, 1fr);
            }
            
            .gallery-thumb {
                height: 80px;
            }
            
            .apartment-title {
                font-size: 1.8rem;
            }
            
            .features-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
        
        @media screen and (max-width: 576px) {
            .gallery-thumbs {
                grid-template-columns: repeat(2, 1fr);
            }
            
            .features-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- Preloader -->
    <div class="preloader">
        <div class="loading-spinner"></div>
    </div>

    <header class="header">
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <a href="{% url 'home' %}">
                        <img src="{% static 'media/logo.jpg' %}" alt="ES Homes &amp; Apartments Logo">
                    </a>
                </div>
                <nav class="nav">
                    <ul class="nav-list" id="nav-list">
                        <li class="nav-item"><a href="{% url 'home' %}" class="nav-link active">Home</a></li>
                        <li class="nav-item"><a href="{% url 'apartments' %}" class="nav-link">Apartments</a></li>
                        <li class="nav-item"><a href="{% url 'about' %}" class="nav-link">About Us</a></li>
                        <li class="nav-item"><a href="{% url 'contact' %}" class="nav-link">Contact</a></li>
                        <li class="nav-item mobile-only"><a href="{% url 'profile' %}" class="nav-link"><i class="fas fa-user-circle fa-lg"></i> </a></li>
                        
                        {% if not user.is_authenticated %}
                            <li class="nav-item mobile-only"><a href="{% url 'user_login' %}" class="btn btn-secondary mobile-btn">Login</a></li>
                        {% endif %}
                        <li class="nav-item mobile-only"><a href="{% url 'apartments' %}" class="btn btn-primary mobile-btn">Book Now</a></li>
                    </ul>
                </nav>
                <button class="nav-toggle" aria-label="Toggle navigation menu" aria-expanded="false" aria-controls="nav-list">
                    <span class="bar"></span>
                    <span class="bar"></span>
                    <span class="bar"></span>
                </button>

            </div>
        </div>
    </header>

    <!-- Apartment Detail Section -->
    <section class="apartment-detail">
        <div class="container">
            <div class="apartment-detail-grid">
                <div class="apartment-gallery reveal reveal--left">
                    <div class="gallery-main">
                        {% if apartment.images.all %}
                            <img src="{{ apartment.images.first.image.url }}" alt="{{ apartment.name }}" class="gallery-main-image" id="mainImage">
                        {% else %}
                            <img src="{% static 'EsHomesApp/images/default-apartment.jpg' %}" alt="{{ apartment.name }}" class="gallery-main-image" id="mainImage">
                        {% endif %}
                    </div>
                    <div class="gallery-thumbs">
                        {% for image in apartment.images.all %}
                        <div class="gallery-thumb {% if forloop.first %}active{% endif %}" data-src="{{ image.image.url }}" onclick="changeImage(this)">
                            <img src="{{ image.image.url }}" alt="{{ apartment.name }} - Image {{ forloop.counter }}">
                        </div>
                        {% endfor %}
                    </div>
                </div>
                
                <div class="apartment-info">
                    <h1 class="apartment-title">{{ apartment.name }}</h1>
                    <div class="apartment-meta">
                        <div class="meta-item">
                            <i class="fas fa-bed"></i>
                            <span>{{ apartment.bedrooms }} Bedroom{% if apartment.bedrooms != 1 %}s{% endif %}</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-bath"></i>
                            <span>{{ apartment.bathrooms }} Bathroom{% if apartment.bathrooms != 1 %}s{% endif %}</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-vector-square"></i>
                            <span>{{ apartment.size_sqft }} sq ft</span>
                        </div>
                        <div class="meta-item">
                            <i class="fas fa-users"></i>
                            <span>Up to {{ apartment.max_occupancy }} Guest{% if apartment.max_occupancy != 1 %}s{% endif %}</span>
                        </div>
                    </div>
                    
                    <div class="apartment-price">
                        <span class="price">₦{{ apartment.price_per_night|floatformat:0 }}</span>
                        <span class="period">per day</span>
                    </div>
                    
                    <p>{{ apartment.description }}</p>
                    
                    <div class="booking-form">
                        <h3>Book This Apartment</h3>
                        <form id="booking-form" action="{% url 'booking' %}" method="post">
                            {% csrf_token %}
                            {% if messages %}
                                <div class="messages">
                                    {% for message in messages %}
                                        <div class="{{ message.tags }}">
                                            {{ message }}
                                        </div>
                                    {% endfor %}
                                </div>
                            {% endif %}
                            
                            <input type="hidden" name="apartment" value="{{ apartment.pk }}">
                            
                            <div class="form-group">
                                <label for="{{ form.check_in_date.id_for_label }}">Check-in Date</label>
                                {{ form.check_in_date }}
                                {% if form.check_in_date.errors %}
                                    <div class="messages">
                                        <div class="error">
                                            {{ form.check_in_date.errors }}
                                        </div>
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="form-group">
                                <label for="{{ form.check_out_date.id_for_label }}">Check-out Date</label>
                                {{ form.check_out_date }}
                                {% if form.check_out_date.errors %}
                                    <div class="messages">
                                        <div class="error">
                                            {{ form.check_out_date.errors }}
                                        </div>
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="form-group">
                                <label for="{{ form.guests.id_for_label }}">Number of Guests</label>
                                {{ form.guests }}
                                {% if form.guests.errors %}
                                    <div class="messages">
                                        <div class="error">
                                            {{ form.guests.errors }}
                                        </div>
                                    </div>
                                {% endif %}
                            </div>

                            <div class="form-group">
                                <label for="{{ form.special_requests.id_for_label }}">Special Requests (Optional)</label>
                                {{ form.special_requests }}
                                {% if form.special_requests.errors %}
                                    <div class="messages">
                                        <div class="error">
                                            {{ form.special_requests.errors }}
                                        </div>
                                    </div>
                                {% endif %}
                            </div>
                            
                            <div class="booking-total">
                                <span class="booking-total-label">Total:</span>
                                <span class="booking-total-price" id="total-price">₦0</span>
                            </div>
                            
                            {% if user.is_authenticated %}
                                <button type="submit" class="btn btn-primary" style="width: 100%;">Book Now</button>
                            {% else %}
                                <a href="{% url 'user_login' %}" class="btn btn-primary" style="width: 100%; display: inline-block; text-align: center;">Book Now</a>
                            {% endif %}
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Features Section -->
    <section class="features-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Apartment Features</h2>
                <p class="section-subtitle">Discover the premium amenities and features of this apartment</p>
            </div>
            
            <div class="features-grid">
                {% for amenity in apartment.amenities.all %}
                <div class="feature-item reveal reveal--up" {% if not forloop.first %}data-delay="{{ forloop.counter }}00"{% endif %}>
                    <div class="feature-icon">
                        <i class="{{ amenity.icon }}"></i>
                    </div>
                    <h3 class="feature-title">{{ amenity.name }}</h3>
                    <p class="feature-text">{{ amenity.description }}</p>
                </div>
                {% endfor %}
            </div>
        </div>
    </section>

    <!-- Description Section -->
    <section class="description-section">
        <div class="container">
            <div class="description-content">
                <div class="description-image reveal reveal--left">
                    {% if apartment.images.first %}
                        <img src="{{ apartment.images.first.image.url }}" alt="{{ apartment.name }} Interior">
                    {% else %}
                        <img src="{% static 'EsHomesApp/images/default-apartment.jpg' %}" alt="{{ apartment.name }} Interior">
                    {% endif %}
                </div>
                <div class="description-text reveal reveal--right">
                    <h3>Apartment Description</h3>
                    <p>{{ apartment.description }}</p>
                    
                    <ul class="description-list">
                        <li><i class="fas fa-check"></i> Master bedroom with en-suite bathroom and walk-in closet</li>
                        <li><i class="fas fa-check"></i> Two additional bedrooms with ample storage space</li>
                        <li><i class="fas fa-check"></i> Spacious living room with comfortable seating and entertainment center</li>
                        <li><i class="fas fa-check"></i> Fully equipped modern kitchen with premium appliances</li>
                        <li><i class="fas fa-check"></i> Dining area with seating for six people</li>
                        <li><i class="fas fa-check"></i> Private balcony with outdoor seating and city views</li>
                        <li><i class="fas fa-check"></i> Three luxurious bathrooms with premium fixtures</li>
                        <li><i class="fas fa-check"></i> Laundry facilities with washer and dryer</li>
                    </ul>
                    
                    <p>Whether you're visiting for business or pleasure, this apartment provides all the comforts of home with the luxury of a high-end hotel. Perfect for families, groups of friends, or business travelers looking for a premium accommodation experience.</p>
                </div>
            </div>
        </div>
    </section>

    <!-- Map Section -->
    <section class="map-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Location</h2>
                <p class="section-subtitle">Conveniently located in the heart of the city</p>
            </div>
            
            <div class="map-container">
                <iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d253682.45932537!2d3.1191206!3d6.5483!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x103b8b2ae68280c1%3A0xdc9e87a367c3d9cb!2sLagos%2C%20Nigeria!5e0!3m2!1sen!2sus!4v1632132015693!5m2!1sen!2sus" allowfullscreen="" loading="lazy"></iframe>
            </div>
        </div>
    </section>

    <!-- Similar Apartments Section -->
    <section class="similar-section">
        <div class="container">
            <div class="section-header">
                <h2 class="section-title">Similar Apartments</h2>
                <p class="section-subtitle">You might also be interested in these apartments</p>
            </div>
            
            <div class="similar-apartments">
                {% for similar in similar_apartments %}
                <div class="apartment-card reveal reveal--up" {% if not forloop.first %}data-delay="{{ forloop.counter }}00"{% endif %}>
                    <div class="apartment-image">
                        {% if similar.images.first %}
                        <img src="{{ similar.images.first.image.url }}" alt="{{ similar.name }}">
                        {% endif %}
                        {% if similar.tag %}
                        <div class="apartment-tag">{{ similar.tag }}</div>
                        {% endif %}
                    </div>
                    <div class="apartment-content">
                        <h3 class="apartment-title">{{ similar.name }}</h3>
                        <div class="apartment-meta">
                            <span><i class="fas fa-bed"></i> {{ similar.bedrooms }} Bedroom{% if similar.bedrooms != 1 %}s{% endif %}</span>
                            <span><i class="fas fa-bath"></i> {{ similar.bathrooms }} Bathroom{% if similar.bathrooms != 1 %}s{% endif %}</span>
                            <span><i class="fas fa-vector-square"></i> {{ similar.size_sqft }} sq ft</span>
                        </div>
                        <p class="apartment-description">{{ similar.description|truncatewords:15 }}</p>
                        <div class="apartment-price">
                            <span class="price">₦{{ similar.price_per_night|floatformat:0 }}</span>
                            <span class="period">per day</span>
                        </div>
                        <div class="apartment-actions">
                            <a href="{% url 'apartment_detail' similar.id %}" class="btn btn-secondary">View Details</a>
                            <a href="{% url 'booking' %}?apartment={{ similar.id }}" class="btn btn-primary">Book Now</a>
                        </div>
                    </div>
                </div>
                {% endfor %}
                
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta section-padding bg-primary">
        <div class="container">
            <div class="cta-content text-center">
                <h2 class="cta-title">Ready to Book Your Stay?</h2>
                <p class="cta-text">Secure your reservation now and experience luxury living at ES Homes & Apartments.</p>
                <div class="cta-buttons">
                    <a href="#booking-form" class="btn btn-light">Book Now</a>
                    <a href="contact.html" class="btn btn-secondary">Contact Us</a>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer Section -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <img src="{% static 'media/logo.jpg' %}" alt="ES Homes &amp; Apartments Logo">
                    <p>Your life, your space, your home.</p>
                </div>
                <div class="footer-links">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="{% url 'home' %}">Home</a></li>
                        <li><a href="{% url 'apartments' %}">Apartments</a></li>
                        <li><a href="{% url 'about' %}">About Us</a></li>
                        <li><a href="{% url 'contact' %}">Contact</a></li>
                        <li><a href="{% url 'booking' %}">Book Now</a></li>
                    </ul>
                </div>
                <div class="footer-contact">
                    <h3>Contact Us</h3>
                    <ul>
                        <li><i class="fas fa-envelope"></i> <a href="mailto:E.sglobal4@gmail.com">E.sglobal4@gmail.com</a></li>
                        <li><i class="fas fa-phone"></i> <a href="tel:+2349065980181">+2349065980181</a> <a href="https://wa.me/2349065980181" class="whatsapp-link"><i class="fab fa-whatsapp"></i></a></li>
                        <li><i class="fas fa-map-marker-alt"></i> House 3, behind Unigas opposite Debbie's Nyanya-Karshi Expressway, Abuja. Nigeria.</li>
                    </ul>
                </div>
                <div class="footer-social">
                    <h3>Follow Us</h3>
                    <div class="social-icons">
                        <a href="https://www.facebook.com/share/1G15kjqjKw/" class="social-icon"><i class="fab fa-facebook-f"></i></a>
                        {% comment %} <a href="#" class="social-icon"><i class="fab fa-instagram"></i></a> {% endcomment %}
                        <a href="https://wa.me/message/7ZNOZ6QZYZAIF1" class="social-icon"><i class="fab fa-whatsapp"></i></a>
                    </div>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2024 ES Homes & Apartments. All rights reserved.</p>
            </div>
        </div>
    </footer>


    <!-- Back to Top Button -->
    <button id="back-to-top" class="back-to-top">
        <i class="fas fa-chevron-up"></i>
    </button>

    <!-- Scripts -->
    <script src="{% static 'js/main.js' %}"></script>
    
    <!-- Booking Form Script -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const checkInDate = document.getElementById('{{ form.check_in_date.id_for_label }}');
            const checkOutDate = document.getElementById('{{ form.check_out_date.id_for_label }}');
            const totalPrice = document.getElementById('total-price');
            const apartmentPrice = {{ apartment.price_per_night }};
            
            // Set minimum dates
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            const formatDate = (date) => {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            };
            
            checkInDate.min = formatDate(today);
            checkOutDate.min = formatDate(tomorrow);
            
            // Calculate total price when dates change
            function calculateTotal() {
                if (checkInDate.value && checkOutDate.value) {
                    const startDate = new Date(checkInDate.value);
                    const endDate = new Date(checkOutDate.value);
                    
                    if (endDate > startDate) {
                        const nights = Math.floor((endDate - startDate) / (1000 * 60 * 60 * 24));
                        const total = nights * apartmentPrice;
                        totalPrice.textContent = `₦${total.toLocaleString()}`;
                    } else {
                        totalPrice.textContent = '₦0';
                    }
                } else {
                    totalPrice.textContent = '₦0';
                }
            }
            
            // Ensure check-out date is after check-in date
            checkInDate.addEventListener('change', function() {
                const startDate = new Date(this.value);
                const nextDay = new Date(startDate);
                nextDay.setDate(nextDay.getDate() + 1);
                checkOutDate.min = formatDate(nextDay);
                
                // If check-out date is before new check-in date, reset it
                if (checkOutDate.value && new Date(checkOutDate.value) <= startDate) {
                    checkOutDate.value = formatDate(nextDay);
                }
                
                calculateTotal();
            });
            
            checkOutDate.addEventListener('change', calculateTotal);
        });
    </script>
    <script src="{% static 'js/animations.js' %}"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Image Gallery
            const galleryThumbs = document.querySelectorAll('.gallery-thumb');
            const mainImage = document.querySelector('.gallery-main-image');
            
            galleryThumbs.forEach(thumb => {
                thumb.addEventListener('click', function() {
                    // Remove active class from all thumbnails
                    galleryThumbs.forEach(t => t.classList.remove('active'));
                    
                    // Add active class to clicked thumbnail
                    this.classList.add('active');
                    
                    // Update main image
                    const imgSrc = this.getAttribute('data-src');
                    mainImage.src = imgSrc;
                    
                    // Add fade animation
                    mainImage.classList.remove('fadeIn');
                    void mainImage.offsetWidth; // Trigger reflow
                    mainImage.classList.add('fadeIn');
                });
            });
            
            // Booking Form
            const checkInInput = document.getElementById('check-in');
            const checkOutInput = document.getElementById('check-out');
            const totalPriceElement = document.getElementById('total-price');
            const pricePerNight = {{ apartment.price_per_night }}; // Get price from Django template
            
            function calculateTotal() {
                const checkInDate = new Date(checkInInput.value);
                const checkOutDate = new Date(checkOutInput.value);
                
                if (checkInDate && checkOutDate && checkOutDate > checkInDate) {
                    const nights = Math.ceil((checkOutDate - checkInDate) / (1000 * 60 * 60 * 24));
                    const totalPrice = nights * pricePerNight;
                    totalPriceElement.textContent = `₦${totalPrice.toLocaleString()}`;
                } else {
                    totalPriceElement.textContent = '₦0';
                }
            }
            
            // Set minimum dates
            const today = new Date();
            const tomorrow = new Date(today);
            tomorrow.setDate(tomorrow.getDate() + 1);
            
            const formatDate = date => {
                const year = date.getFullYear();
                const month = String(date.getMonth() + 1).padStart(2, '0');
                const day = String(date.getDate()).padStart(2, '0');
                return `${year}-${month}-${day}`;
            };
            
            checkInInput.min = formatDate(today);
            checkOutInput.min = formatDate(tomorrow);
            
            // Event listeners
            checkInInput.addEventListener('change', function() {
                const nextDay = new Date(this.value);
                nextDay.setDate(nextDay.getDate() + 1);
                checkOutInput.min = formatDate(nextDay);
                
                if (checkOutInput.value && new Date(checkOutInput.value) <= new Date(this.value)) {
                    checkOutInput.value = formatDate(nextDay);
                }
                
                calculateTotal();
            });
            
            checkOutInput.addEventListener('change', calculateTotal);
        });
    </script>
</body>
</html>